# Render Blueprint: WebSocket server (with in-process physics) + Next.js app.
# Dashboard: https://dashboard.render.com/blueprints

services:
  # WebSocket server + physics (y-websocket relay and matter.js in one process)
  - type: web
    name: cursor-bounce-ws
    runtime: node
    rootDir: ws-server
    plan: free
    buildCommand: npm install
    startCommand: npm start
    envVars:
      - key: HOST
        value: 0.0.0.0
      # PORT set by Render; ROOM defaults to demo-room

  # Next.js frontend
  - type: web
    name: cursor-bounce-app
    runtime: node
    rootDir: client
    plan: free
    buildCommand: npm install && npm run build
    startCommand: npm start
    envVars:
      # Replace with your WebSocket service URL after first deploy:
      # e.g. wss://cursor-bounce-ws.onrender.com
      - key: NEXT_PUBLIC_WS_URL
        sync: false
        # After deploying, set this in the app's Environment tab to:
        # wss://<your-ws-service-name>.onrender.com
